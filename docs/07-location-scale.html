<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Statistical Theory - 7&nbsp; Location Scale Families</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./06-normality.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="mystyles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-location-scale.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Location Scale Families</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Intro Statistical Theory</a> 
        <div class="sidebar-tools-main">
    <a href="./ma382-text.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Essential Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-randomvariables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Random Variables and Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-samplingdistributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sampling Distribution of a Statistic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference for a Population Mean</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for Regression Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-normality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">More on the Classical Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-location-scale.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Location Scale Families</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-location-scale" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Location Scale Families</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>As we have seen, the Normal distribution plays a large role in classical statistical theory. However, it is just one example of a location-scale family. In this chapter, we briefly discuss a key property of location-scale families — probability plots.</p>
<div id="def-location-scale" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.1 (Location-Scale Family) </strong></span>For <span class="math inline">\(a \in \mathbb{R}\)</span> and <span class="math inline">\(b &gt; 0\)</span>, let <span class="math inline">\(X = a + bZ\)</span> for some random variable <span class="math inline">\(Z\)</span>. <span class="math inline">\(X\)</span> is said to be the location-scale family associated with the distribution of <span class="math inline">\(Z\)</span> with location parameter <span class="math inline">\(a\)</span> and scale parameter <span class="math inline">\(b\)</span>.</p>
</div>
<p>While technically we can create a location-scale family for any distribution, we generally think of those distributions for which the support remains unchanged. Many such distributions we have seen belong to this class.</p>
<div id="exm-exponential-scale" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.1 (Scale Family: Exponential Distribution) </strong></span>The Exponential distribution is a scale family (the location parameter is 0). Let <span class="math inline">\(X\)</span> follow an Exponential distribution with scale parameter <span class="math inline">\(\lambda\)</span>. Show that <span class="math inline">\(aX\)</span> also follows an Exponential distribution with scale parameter <span class="math inline">\(a\lambda\)</span>.</p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Let <span class="math inline">\(Y = aX\)</span>, then the CDF of <span class="math inline">\(Y\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
  F_Y(y)
    &amp;= Pr(Y \leq y) \\
    &amp;= Pr(aX \leq y) \\
    &amp;= Pr(X \leq y/a) \\
    &amp;= F_X(y/a) \\
    &amp;= 1 - e^{-\frac{y}{a\lambda}},
\end{aligned}
\]</span></p>
<p>which we recognize as the CDF of an Exponential distribution with scale parameter <span class="math inline">\(a\lambda\)</span>.</p>
</div>
<p>The above example illustrates a very helpful result regarding location-scale families.</p>
<div id="thm-location-scale" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7.1 (CDF for Location-Scale Families) </strong></span>Let <span class="math inline">\(Z\)</span> be a random variable with CDF <span class="math inline">\(F_Z(z)\)</span>, and define <span class="math inline">\(X = aZ + b\)</span> for <span class="math inline">\(a \in \mathbb{R}\)</span> and <span class="math inline">\(b &gt; 0\)</span>. Then,</p>
<p><span class="math display">\[F_X(x) = F_Z\left(\frac{x - a}{b}\right).\]</span></p>
</div>
<p>That is, the CDF for a location-scale family is a function of the CDF of the “standard” distribution, the location parameter, and the scale parameter. Throughout a course in probability, we often make use of this property when computing probabilities of a Normal distribution (this is essentially what every Normal table in the back of a probability textbook is relying on). However, we can exploit this feature of location-scale families for much more than creating a table to enable “by-hand” computations of probabilities.</p>
<div id="exm-location-scale-quantiles" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.2 (Quantiles of a Location-Scale Family) </strong></span>Let <span class="math inline">\(X \sim F_X\)</span> be a random variable belonging to a location-scale family with location parameter <span class="math inline">\(a \in \mathbb{R}\)</span> and scale parameter <span class="math inline">\(b &gt; 0\)</span>. Let <span class="math inline">\(Z \sim F_Z\)</span> be the “standard” distribution generating this location-scale family. Find an expression for the <span class="math inline">\(q\)</span>-th quantile of <span class="math inline">\(X\)</span> as a function of the <span class="math inline">\(q\)</span>-th quantile of <span class="math inline">\(Z\)</span>.</p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>The <span class="math inline">\(q\)</span>-th quantile of <span class="math inline">\(X\)</span>, call it <span class="math inline">\(X_q\)</span>, is the value such that</p>
<p><span class="math display">\[q = F_X\left(X_q\right).\]</span></p>
<p>By <a href="#thm-location-scale">Theorem&nbsp;<span>7.1</span></a>, we have that</p>
<p><span class="math display">\[q = F_Z\left(\frac{X_q - a}{b}\right).\]</span></p>
<p>This implies that the <span class="math inline">\(q\)</span>-th quantile of <span class="math inline">\(Z\)</span>, call it <span class="math inline">\(Z_q\)</span> is given by</p>
<p><span class="math display">\[\frac{X_q - a}{b}.\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[X_q = Z_q b + a.\]</span></p>
</div>
<p><a href="#exm-location-scale-quantiles">Example&nbsp;<span>7.2</span></a> reveals that the quantiles of a location-scale distribution are linearly related to the quantiles of the corresponding “standard” distribution.</p>
<p>In order to see how this can be useful in a statistical analysis, we must first consider how we define a sample quantile. Our first pass at a definition might go something like the following:</p>
<blockquote class="blockquote">
<p>The <span class="math inline">\(q\)</span>-th sample quantile is the value <span class="math inline">\(k\)</span> such that <span class="math inline">\(100q\)</span>% of observed vales in the sample are no more than <span class="math inline">\(k\)</span>.</p>
</blockquote>
<p>While this makes intuitive sense, we recognize that it does not result in a unique value. For example, consider a the simple sample <span class="math inline">\(\{1, 2, 3, 4, 5\}\)</span>. In this sample, 60% of observations in the sample have a value no more than 3; so, it would seem that 3 represents the 0.6 quantile. But, we also know that 60% of observations have a value no more than 3.5; so, 3.5 is also the 0.6 quantile. More, we would generally consider 3 to be the median (0.5 quantile) of the sample! It seems our working definition of a sample quantile seems a bit off. In order to create a more rigorous definition, we first need the concept of an order statistic.</p>
<div id="def-order-statistic" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.2 (Order Statistic) </strong></span>Let <span class="math inline">\(X_1, X_2, \dotsc, X_n\)</span> be a random sample of size <span class="math inline">\(n\)</span>. The <span class="math inline">\(j\)</span>-th order statistic, denoted <span class="math inline">\(X_{(j)}\)</span> is the <span class="math inline">\(j\)</span>-th smallest value in the sample. Special cases include</p>
<ul>
<li><span class="math inline">\(X_{(1)}\)</span>, the sample minimum, and</li>
<li><span class="math inline">\(X_{(n)}\)</span>, the sample maximum.</li>
</ul>
</div>
<div id="def-sample-quantile" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.3 (Sample Quantile) </strong></span>Let <span class="math inline">\(x_{(j)}\)</span> denote the <span class="math inline">\(j\)</span>-th observed order statistic in a sample. Then, the <span class="math inline">\(q\)</span>-th quantile of the sample is given by <span class="math inline">\(x_{(j)}\)</span> for <span class="math inline">\(\frac{j-1}{n} &lt; q \leq \frac{j}{n}\)</span> and <span class="math inline">\(x_{(1)}\)</span> if <span class="math inline">\(q = 0\)</span>, for <span class="math inline">\(j=1,2,\dotsc,n\)</span>.</p>
</div>
<p>Let’s apply the above definition to our sample <span class="math inline">\(\{1, 2, 3, 4, 5\}\)</span>. For the median, we have <span class="math inline">\(q = 0.5\)</span>, which falls between <span class="math inline">\(\frac{2}{5}\)</span> and <span class="math inline">\(\frac{3}{5}\)</span>; therefore, we take the third observation in the dataset, which is 3.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are several accepted definitions for computing a sample quantile. In fact, the default definition used by the major statistical software packages (SAS, R, SPSS) do not agree. In large sample sizes, the results are nearly identical. For smaller samples, the results can differ dramatically; however, this is not cause for alarm in practice. If quantiles are the focal point of an analysis, be sure to check the definition being used by your software.</p>
</div>
</div>
<p>Let’s consider applying the above to a sample from a Normal distribution. In particular, consider taking a random sample of 15 observations from a Normal distribution with a <em>known</em> mean of <span class="math inline">\(\mu\)</span> and a <em>known</em> variance of <span class="math inline">\(\sigma^2\)</span>. For these 15 observations, note that we have that</p>
<p><span class="math display">\[Q\left(\frac{j - 0.5}{15}\right) = X_{(j)}\]</span></p>
<p>where <span class="math inline">\(Q(p)\)</span> represents the <span class="math inline">\(p\)</span>-th quantile for <span class="math inline">\(j = 1,2,\dotsc, 15\)</span>. The choice of the these 15 quantiles is somewhat arbitrary but provides 15 evenly spaced points over the interval <span class="math inline">\((0, 1)\)</span>. Additionally, since each observation is from a known Normal distribution, we can apply the results of <a href="#exm-location-scale-quantiles">Example&nbsp;<span>7.2</span></a> to recognize that</p>
<p><span class="math display">\[X_{(j)} = Z_{(j - 0.5)/15} \sigma + \mu,\]</span></p>
<p>where</p>
<p><span class="math display">\[Z_{(j - 0.5)/15} = \begin{cases} -1.83 &amp; j = 1 \\ -1.28 &amp; j = 2 \\ \dotsc &amp; \dotsc \\ 1.83 &amp; j = 15\end{cases}\]</span></p>
<p>are known values since <span class="math inline">\(Z \sim N(0, 1)\)</span>. Therefore, a plot of the observed order statistics against the corresponding quantiles of a Standard Normal distribution will fall along a line with a slope of <span class="math inline">\(\sigma\)</span> and an intercept of <span class="math inline">\(\mu\)</span>.</p>
<p>Of course, in practice, we do not know <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, but we can rely on this same idea because it should work for <em>any</em> choice of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Assessing Normality
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a sample of size <span class="math inline">\(n\)</span>, a plot of the observed quantiles against the quantiles from a Standard Normal distribution will be roughly linear if the sample is from a Normal distribution. The slope of the relationship will be an estimate of the standard deviation, and the intercept of the relationship will be an estimate of the average.</p>
</div>
</div>
<p>This graphic that is constructed is known as a “Quantile-Quantile” plot; it is also known as a “Probability Plot” as it is sometimes presented equivalently with different scales. Again, while the choice of which quantiles should be considered when constructing the plot is somewhat arbitrary, we want to select <span class="math inline">\(n\)</span> evenly spaced points across the interval <span class="math inline">\((0, 1)\)</span>, making use of all the unique information in the sample. One such choice was illustrated above, choosing quantiles to correspond to <span class="math inline">\(\frac{j - 0.5}{n}\)</span> for <span class="math inline">\(j = 1,2,\dotsc,n\)</span>.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06-normality.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">More on the Classical Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>