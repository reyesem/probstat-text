{"title":"Autocorrelation","markdown":{"headingText":"Autocorrelation","headingAttr":{"id":"sec-autocorrelation","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\n{{< include _setupcode.qmd >}}\n\nA critical assumption throughout the text has been that of independence.  For example, we might assume that \n\n$$Y_i = \\mu + \\varepsilon_i$$\n\nwhere the $\\varepsilon_i$ are independent random variables.  For a more concrete example, suppose we say that $\\mu = 0$ and $\\varepsilon \\sim N(0, 1)$, again, all independent.  And, suppose we take a sample of size 100.  @fig-time-series illustrates several possible samples, where the observations are made sequentially.  That is, @fig-time-series shows several time-series plots (plot of the observations over time).\n\n```{r}\n#| label: fig-time-series\n#| fig-cap: The time-series plot for several random samples of size 100 taken from a Standard Normal distribution.  One sample is highlighted for illustration.  No visible patterns are present.\n\nset.seed(20240826)\n\nplotdat <- tibble(\n  Observation = rep(seq(100), times = 10),\n  Group = rep(seq(10), each = 100),\n  Highlight = (Group == 1),\n  Response = rnorm(length(Observation))\n)\n\nggplot(plotdat) +\n  aes(y = Response, x = Observation) +\n  geom_line(mapping = aes(group = Group), color = 'grey75', alpha = 0.5) +\n  geom_line(\n    data = filter(plotdat, Highlight),\n    color = 'black', linewidth = 1.1\n  ) +\n  geom_point(\n    data = filter(plotdat, Highlight)\n  )\n```\n\nThere are no visible trends in the location or spread of the responses as we move across the graphic.  While any one time-series plot _may_ show some small trend, overall, across repeated samples, no trend is observed.  This lack of trend is the result of the independence between observations.  Any one observation does not help us predict the location of the next.\n\n\nIn contrast, suppose we continue to take $\\mu = 0$, but we say that $\\varepsilon_1 \\sim N(0, 1)$ and \n\n$$\\varepsilon_i \\mid \\varepsilon_{i-1} \\sim N\\left(\\varepsilon_{i-1}, 1\\right)$$\n\nfor $i = 2, 3, \\dotsc, n$.  Notice that the distribution of one error term depends on the value of the previous error.  We again consider taking a sample of size 100.  @fig-time-series-auto shows several time-series plots for this updated situation.\n\n```{r}\n#| label: fig-time-series-auto\n#| fig-cap: The time-series plot for several samples of size 100 taken sequentially.  The first observation is taken from a Standard Normal distribution; each subsequent observation is taken from a Normal distribution centered on the previous observation with a variance of 1.  One sample is highlighted for illustration.  \n\nset.seed(20240826)\n\nplotdat <- tibble(\n  Observation = rep(seq(100), times = 10),\n  Group = rep(seq(10), each = 100),\n  Highlight = (Group == 4),\n  Response = NA\n)\n\nfor (i in 1:nrow(plotdat)) {\n  if (plotdat$Observation[i] == 1) {\n    plotdat$Response[i] <- rnorm(1)\n  } else {\n    plotdat$Response[i] <- rnorm(1, mean = plotdat$Response[i-1])\n  }\n}\n\nggplot(plotdat) +\n  aes(y = Response, x = Observation) +\n  geom_line(mapping = aes(group = Group), color = 'grey75', alpha = 0.5) +\n  geom_line(\n    data = filter(plotdat, Highlight),\n    color = 'black', linewidth = 1.1\n  ) +\n  geom_point(\n    data = filter(plotdat, Highlight)\n  )\n```\n\nUnlike @fig-time-series, we notice a clear trend in the location of the series highlighted in @fig-time-series-auto.  The location of the response tends to decrease over time.  The lack of independence is revealing itself in a trend in the location of the response over time.\n\nThis is known as auto-correlation.  While the specifics of this phenomena would be studied in a course on regression modeling, what we see is that the relationship between one observation and the next is time-dependent.  That is, observations close together in time (indices that are near one another) are related to one another, while observations further apart in time are less related to one another.\n\n:::{#exm-covariance-auto}\n## Covariance in Autocorrelation Model\nConsider the simple autocorrelation model\n\n$$Y_i = \\varepsilon_i$$\n\nwhere $\\varepsilon_1 \\sim N(0, 1)$ and \n\n$$\\varepsilon_i \\mid \\varepsilon_{i-1} \\sim N\\left(\\varepsilon_{i-1}, 1\\right)$$\n\nfor $i > 1$.  Determine the covariance between two observations.\n:::\n\n:::{.soln}\nWithout loss of generality, consider $Y_1$ and $Y_2$.  Observe that\n\n$$Cov\\left(Y_1, Y_2\\right) = Cov\\left(\\varepsilon_1, \\varepsilon_2\\right) = E\\left(\\varepsilon_{1} \\varepsilon_{2}\\right) - E\\left(\\varepsilon_{1}\\right)E\\left(\\varepsilon_{2}\\right).$$\n\nIn order to evaluate these expectations, we need an interim result: for any two random variables $X$ and $Y$, we have that $E(X) = E(E(X \\mid Y))$.  That is, in the inner expectation, we take the conditional expectation of $X$ given $Y$; the result will be only a function of the random variable $Y$.  In the outer expectation, we take the expectation with respect to $Y$.\n\nReturning to our problem at hand, we know that $E\\left(\\varepsilon_1\\right) = 0$.  Applying our latest result, we have\n\n$$\n\\begin{aligned}\n  E\\left(\\varepsilon_2\\right) \n    &= E\\left[E\\left(\\varepsilon_2 \\mid \\varepsilon_1\\right)\\right] \\\\\n    &= E\\left[\\varepsilon_1\\right] \\\\\n    &= 0.\n\\end{aligned}\n$$\n\nWe also have that\n\n$$\n\\begin{aligned}\n  E\\left(\\varepsilon_1 \\varepsilon_2\\right) \n    &= E\\left[E\\left(\\varepsilon_1 \\varepsilon_2 \\mid \\varepsilon_1\\right)\\right] \\\\\n    &= E\\left[ \\varepsilon_1 E\\left(\\varepsilon_2 \\mid \\varepsilon_1\\right)\\right] \\\\\n    &= E\\left[\\varepsilon_1^2\\right] \\\\\n    &= Var\\left(\\varepsilon_1\\right) + E^2\\left(\\varepsilon_1\\right) \\\\\n    &= 1.\n\\end{aligned}\n$$\n\nLine 2 comes from recognizing that if we are \"given\" $\\varepsilon_1$, then it is constant in terms of the inner expectation and comes out of the expectation.  Now, we have shown that\n\n$$Cov\\left(Y_1, Y_2\\right) = 1$$\n\nmeaning that there is a correlation between terms that are next to one another.  \n:::\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["mystyles.css"],"output-file":"10-autocorrelation.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","bibliography":["refs382notes.bib","packages.bib"],"comments":{"hypothesis":false},"fig-cap-location":"bottom","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":true,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"10-autocorrelation.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"block-headings":true,"bibliography":["refs382notes.bib","packages.bib"],"comments":{"hypothesis":false},"fig-cap-location":"bottom","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}